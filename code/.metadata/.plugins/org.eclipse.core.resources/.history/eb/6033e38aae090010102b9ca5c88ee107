package com.pikitus.games.go.handlers;

import com.smartfoxserver.v2.entities.User;
import com.smartfoxserver.v2.entities.data.ISFSObject;
import com.smartfoxserver.v2.entities.data.SFSObject;
import com.smartfoxserver.v2.extensions.BaseClientRequestHandler;
import com.pikitus.games.go.SFSGo;
import com.pikitus.games.go.models.MoveModel;
//import com.pikitus.games.go.models.MoveModel;

public class MoveHandler extends BaseClientRequestHandler
{
	@Override
	public void handleClientRequest(User user, ISFSObject params)
	{
		SFSGo gameExt = (SFSGo) getParentExtension();
		
		if ( !user.isPlayer() ) 
		{
			return ;
		}
	
		if ( gameExt.getWhoseTurn() != user ) {
			return ;
		}

		if ( ! gameExt.isStarted() ) 
		{
			
		}

		MoveModel move = (MoveModel) params.getClass("move");
		movePiece(gameExt, user, move); 
	}
	
	/**
	 * Move a piece and send the results
	 */
	public void movePiece( SFSGo sfsGo, User user, MoveModel move ) 
	{
		sfsGo.movePiece( move );
//		ISFSObject resObj = new SFSObject();
//		
//		boolean valid = sfsChess.getGameBoard().movePiece( new MoveModel( from, to ) );
//		resObj.putBool("valid", valid );
//		resObj.putUtfString("from", from);
//		resObj.putUtfString("to", to);
//		
//		// Is it a valid move
//		if ( valid ) 
//		{
//			sfsChess.sendSFSObject("MOVE_PIECE_RESULTS", resObj);
//		} 
//		else 
//		{
//			sfsChess.sendSFSObject("MOVE_PIECE_RESULTS", resObj, user);
//		}
	}	
}