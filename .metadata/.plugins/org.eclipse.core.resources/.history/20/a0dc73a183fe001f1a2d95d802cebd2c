package com.pikitus.games.chess.handlers;

import com.pikitus.games.chess.ChessBoard;
import com.pikitus.games.chess.SFSChess;
import com.smartfoxserver.v2.entities.User;
import com.smartfoxserver.v2.entities.data.ISFSObject;
import com.smartfoxserver.v2.extensions.BaseClientRequestHandler;

public class ValidMoveHandler extends BaseClientRequestHandler 
{
	ChessBoard mGameBoard;
	
	public ValidMoveHandler(ChessBoard board)
	{
		mGameBoard = board;
	}
	
	@Override
	public void handleClientRequest(User user, ISFSObject params)
	{
		SFSChess gameExt = (SFSChess) getParentExtension();
		
		if (user.isPlayer())
		{
			//gameExt.sendBoard(user);

			// Checks if two players are available and start game
			if (gameExt.getParentRoom().getSize().getUserCount() == 2)
				gameExt.startGame();
		}		
	}
	
	public void sendBoard() 
	{
		send("VALID_MOVES", mGameBoard.getBoardArray(), getParentRoom().getUserList());		
	}

}
